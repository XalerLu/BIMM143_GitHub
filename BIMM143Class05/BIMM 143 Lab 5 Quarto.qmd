---
title: "BIMM 143 Class 5"
author: "Xaler Lu PID(A17388454)"
format: pdf
toc: TRUE
---

## Background

R has many ways to make figures like "base R" graphics (eg. `plot()`) and tons of add-on packages like **ggplot2**.
For example, here we make the sample plot with both "base R" and with **ggplot2**.

```{r}
head(cars)
plot(cars)
```

However, I do not have **ggplot** downloaded yet, so I will need `install.packages()`. \

>  **N.B.** We never run an install command in a quarto code chunk or we will end up reinstalling packages many times

We would then need to load the ggplot from the library with `library()`. 
Afterwards, every ggplot would need at least three things: \
\ -  **data**: The stuff you want to be plotted \
\ - **aes**thetics: How the data map to the plot \
\ - **geom**metry: The type of plot \
```{r}
library(ggplot2)
p <- ggplot(cars) + 
  aes(x=speed, y=dist) + 
  geom_point(color = 'black') +
  geom_smooth(method="lm", se=FALSE, formula = 'y ~ x', color = 'red') +
  labs(title="Stopping distance of old cars", 
       subtitle="Data from the 'cars' dataset",
       x = "Speed (mph)",
       y = "Distance (ft)")
p

```

We set a variable for the `ggplot` to later add a theme with `theme`.
```{r}
p + theme_minimal()
```
## Gene Expression Plot

Here is some code to answer some questions
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
nrow(genes)
ncol(genes)
table(genes$State)
round(table(genes$State)/nrow(genes) * 100, 2)
```

Version 1 of the `ggplot`
```{r}
ggplot(genes) +
  aes(Condition1, Condition2) +
  geom_point()
```


Version 2 of the `ggplot` with colors by `State`.
```{r}
ggplot(genes) +
  aes(Condition1, Condition2, color = State) +
  geom_point()
```

Version 3 of the `ggplot` to further modify the colors with `scale_color_manual` and to add titles with `labs`

```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col = State) +
  geom_point() +
  scale_color_manual( values = c("blue","#8968CD", "red")) +
  labs(x = "Control (no drug",
       y = "Drug",
       title = "Gene Expression Changes upon GLP-1 drug") +
  theme_minimal()
```

## Going Further

Setting up
```{r}
library(gapminder)
library(dplyr)
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
head(gapminder, 4)
```

Version 1 of the `ggplot` 
```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point(alpha = 0.3) 
  
```


Now, let's "facet" (i.e. make a separate plot) by continent with `facet_wrap`
```{r}
ggplot(gapminder) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point(alpha = 0.3) +
  facet_wrap(~continent) +
  labs(title = "Life Expectancy Based on GDP per Capita",
       x = "GDP per Capita",
       y = "Life Expectancy (Years)")
```

How big is this gapmider data? How do we separate the data by year? \
> **N.B.** Hint, we will use the `filter` function from the `dplyr` package

```{r}
library(dplyr)
nrow(gapminder)
```

Here, I will select the data only from 2007 that also includes the size of the population using `size`. \
```{r}
gapminder_2007 <- filter(gapminder, year == 2007)
ggplot(gapminder_2007) +
  aes(gdpPercap, lifeExp, col = continent, size = pop) +
  geom_point(alpha = 0.3) 
```

Here, I will filter even further by countries.

```{r}
gapminder_2007_Ireland <- filter(gapminder, year == 2007, country == "Ireland")
gapminder_2007_Ireland
filter(gapminder, year == 2007, country == "United States")
```

> Q. Make a plot comparing 1977 and 2007 for all countries

```{r}
gapminder_compare <- filter(gapminder, year %in% c(1977, 2007))
ggplot(gapminder_compare) +
  aes(gdpPercap, lifeExp, col = continent) +
  geom_point(alpha = 0.) + 
  facet_wrap(~year) +
  labs(title = "GDP per Capita to Life Expectancy in 1977 and 2007", 
       x = "GDP per Capita", 
       y = "Life Expectancy (Year)")
```

```{r}
ggplot(mtcars) + aes(x=mpg, y=disp) + geom_point()
```


```{r}
ggplot(mtcars, aes(wt, mpg, shape = disp)) +
  geom_point()
```

